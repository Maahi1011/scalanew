    CREATE EXTERNAL TABLE pubz_datalake_cnfd_prv.prescription (
      prescription_id string,
      automatically_refill_ind boolean,
      automatically_renew_ind boolean,
      dose_type_desc string,
      external_prescription_nbr string,
      prescription_nbr string,
      source_system_external_id string,
      ingestion_document_resource_id string,
      label_prescription_nbr string,
      referral_resource_id string,
      relative_id string,
      nrx_prescription_id string,
      tenant_id string,
      prescription_resource_id string,
      renewal_ind boolean,
      source_system_origin_cde string,
      source_system_id string,
      temporary_renewed_from_prescription_id string,
      from_prescription_transfer_id string,
      to_prescription_transfer_id string,
      from_prescription_renewal_resource_id string,
      to_prescription_renewal_resource_id string,
      source_system_insert_tms timestamp,
      source_system_insert_tms_txt string,
      source_system_insert_timezone_txt string,
      document_reference_resource_id string,
      current_fill_nbr string,
      fill_type_desc string,
      from_prescription_renewal_id string,
      to_prescription_renewal_id string,
      cancel_txt string,
      temporary_renewed_from_prescription_resource_id string,
      transferred_from_prescription_resource_id string,
      transferred_to_prescription_resource_id string,
      transferred_from_label_prescription_nbr string,
      transferred_to_label_prescription_nbr string,
      expiration_dte date,
      received_dte date,
      written_dte date,
      refill_reminder_dte date,
      renewal_reminder_dte date,
      reorder_dte date,
      data_lake_last_update_tms timestamp,
      source_system_last_update_tms timestamp,
      source_system_last_update_tms_txt string,
      source_system_last_update_timezone_txt string,
      void_ind boolean,
      stop_cde string,
      dod_deployed_ind boolean,
      refill_remaining_qty integer,
      expiration_days_qty integer,
      fills_allowed_qty integer,
      prescribed_items array<struct< item_category_desc:string, created_tms:timestamp, created_tms_txt:string, created_timezone_txt:string, dosage_units_txt:string, directions_txt:string, dose_frequency_txt:string, item_type_desc:string, item_compound_ind:boolean, drug_nbr:string, item_resource_id:string, notes_txt:string, patient_dispense_as_written_desc:string, patient_dispense_as_written_nme:string, prescriber_dispense_as_written_desc:string, prescriber_dispense_as_written_nme:string, prescribed_item_relative_id:string, drug_route_txt:string, last_updated_tms:timestamp, last_updated_tms_txt:string, last_updated_timezone_txt:string, supply_id:string, cycle_days_qty:integer, days_supply_qty:integer, dosage_qty:double, label_print_qty:integer, daily_dosage_qty:double, dispensed_quantity_unit_txt:string, dispensed_qty:double, prescribed_item_store_key:array<struct< store_nme:string, key_nme:string, primary_store_ind:boolean, component_nme:string, component_value_txt:string >>, item_store_key:array<struct< store_nme:string, key_nme:string, primary_store_ind:boolean, component_nme:string, component_value_txt:string >> >>,
      prescriber array<struct< renewal_ind:boolean, dea_nbr:string, fax_nbr:string, first_nme:string, npi_nbr:string, last_nme:string, phone_nbr:string, patient_provided_ind:boolean, pracitioner_resource_id:string, state_license_nbr:string, city_nme:string, country_iso2_cde:string, country_iso3_cde:string, postal_cde:string, state_cde:string, state_nme:string, medical_education_nbr:string, pharmacy_practice_nbr:string, street_address_txt:array<string> >>,
      event array<struct< event_tms:timestamp, event_tms_txt:string, event_timezone_txt:string, source_application_nme:string, event_type_desc:string, source_application_user_nme:string, current_ind:boolean >>,
      referral_documents array<struct< referral_document_file_id:string, referral_document_reference_creation_tms:timestamp, referral_document_reference_creation_tms_txt:string, referral_document_reference_creation_timezone_txt:string >>,
      for_patient array<struct< customer_nbr:string, mail_group_desc:string, patient_automatically_generated_nbr:string, person_nbr:string, person_resource_id:string, specialty_profile_id:string, sub_group_desc:string, previous_patient_type_desc:string, membership_agn_id:string >>,
      previous_for_patient array<struct< person_resource_id:string, specialty_profile_id:string, patient_type_desc:string, expiration_tms:timestamp, expiration_tms_txt:string, expiration_timezone_txt:string >>,
      status array<struct< effective_tms:timestamp, status_desc:string, effective_tms_txt:string, effective_timezone_txt:string, current_ind:boolean >>,
      receiving_pharmacy_store_key array<struct< store_nme:string, key_nme:string, primary_store_ind:boolean, component_nme:string, component_value_txt:string >>,
      fills array<struct< prescription_fill_id:string, auto_refilled_ind:boolean, source_system_created_tms:timestamp, external_id:string, fill_tms:timestamp, fill_nbr:string, fill_type_desc:string, refill_reminder_dte:date, prescription_Fill_relative_id:string, reorder_dte:date, fill_last_update_tms:timestamp, source_system_last_update_tms:timestamp, refill_source_system_tms:timestamp, completed_ind:boolean, original_source_system_nme:string, refill_last_update_tms:timestamp, source_system_created_timestamp_txt:string, source_system_created_timezone:string, refill_last_update_tms_txt:string, refill_last_update_timezone:string, refill_source_system_tms_txt:string, refill_source_system_timezone_txt:string, fill_timestamp_txt:string, fill_timezone_txt:string, fill_last_update_tms_txt:string, fill_last_update_timezone_txt:string, provisional_fill_ind:boolean, dispensing_pharmacy_line_of_business_txt:string, fill_dte:date, fulfillment_center_id:string, invoice_nbr:string, primary_membership_client_id:string, actual_dispensed_qty:double, actual_fill_qty:double, fill_status:array<struct< effective_tms:timestamp, fill_status_txt:string, current_ind:boolean, effective_tms_txt:string, effective_Timezone_txt:string, fill_status_detail:struct< cancel_desc:string, stop_ind:string, status_desc:string >, fill_status_explaination:struct< status_explaination_desc:string, status_explaination_message_txt:string, soba_desc:string > >>, fill_dispensing_item:array<struct< item_category_desc:string, directions_txt:string, dosage_units_txt:string, dose_frequency_txt:string, item_type_desc:string, item_compound_ind:boolean, ndc_nbr:string, drug_nbr:string, item_resource_id:string, notes_txt:string, dispense_as_written_desc:string, dispense_as_written_nme:string, prescribed_item_relative_id:string, dispensed_item_relative_id:string, created_tms:timestamp, created_tms_txt:string, created_timezone_txt:string, drug_route_txt:string, last_updated_tms:timestamp, last_updated_tms_txt:string, last_updated_timezone_txt:string, dispensed_quantity_unit_txt:string, supply_id:string, cycle_days_qty:integer, days_supply_qty:integer, dosage_qty:double, label_print_qty:integer, dispensed_qty:double, fill_dispensed_item_store_key:array<struct< store_nme:string, key_nme:string, primary_store_ind:boolean, component_nme:string, component_value_txt:string >>, fill_item_store_key:array<struct< store_nme:string, key_nme:string, primary_store_ind:boolean, component_nme:string, component_value_txt:string >> >>, fill_event:array<struct< event_tms:timestamp, event_tms_txt:string, event_timezone_txt:string, source_application_nme:string, event_type_desc:string, source_application_user_nme:string, current_ind:boolean >>, fill_dispensing_pharmacy_store_key:array<struct< store_nme:string, key_nme:string, primary_store_ind:boolean, component_nme:string, component_value_txt:string >>, fill_replacement:array<struct< replacement_prescription_fill_relative_id:string, source_system_created_tms:timestamp, source_system_created_tms_txt:string, source_system_created_timezone_txt:string >>, fill_protocol:array<struct< protocol_tms:timestamp, protocol_tms_txt:string, protocol_timezone_txt:string, source_system_created_tms:timestamp, source_system_created_tms_txt:string, source_system_created_timezone_txt:string, fulfillment_center_id:string, protocol_reason_txt:string, protocol_resolution_tms:timestamp, protocol_resolution_tms_txt:string, protocol_resolution_Timezone_txt:string, source_system_last_updated_tms:timestamp, source_system_last_updated_tms_txt:string, source_system_last_updated_timezone_txt:string, sequence_nbr:integer, invoice_nbr:string >> >>,
      scheduled_fill array<struct< created_tms:timestamp, created_tms_txt:string, created_timezone_txt:string, next_fill_dte:date, pending_final_tms:timestamp, pending_final_tms_txt:string, pending_final_timezone_txt:string, status_desc:string, scheduled_fill_type_desc:string, source_system_last_update_user_id:string, source_system_last_update_tms:timestamp, source_system_last_update_tms_txt:string, source_system_last_update_timezone_txt:string >>,
      store_key array<struct< store_nme:string, key_nme:string, secondary_store_ind:boolean, component_nme:string, component_value_txt:string >>,
      carrier_operational_id string
    )
    STORED AS ORC
    LOCATION '/datahubez/pubz/datalake/published/conformed_prv/pubz_datalake_cnfd_prv.db/prescription';
